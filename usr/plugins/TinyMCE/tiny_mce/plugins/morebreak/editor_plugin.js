(function(){tinymce.create('tinymce.plugins.MoreBreakPlugin',{init:function(c,d){var f='<img src="'+d+'/img/trans.gif" class="mceMoreBreak mceItemNoResize" />',cls='mceMoreBreak',sep=c.getParam('morebreak_separator','<!--more-->'),pbRE;pbRE=new RegExp(sep.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return'\\'+a}),'g');c.addCommand('mceMoreBreak',function(){c.execCommand('mceInsertContent',0,f)});c.addButton('morebreak',{title:"<!--more-->",cmd:cls,image:d+'/img/morebtn.png'});c.onInit.add(function(){if(c.settings.content_css!==false)c.dom.loadCSS(d+"/css/content.css");if(c.theme.onResolveName){c.theme.onResolveName.add(function(a,o){if(o.node.nodeName=='IMG'&&c.dom.hasClass(o.node,cls))o.name='morebreak'})}});c.onClick.add(function(a,e){e=e.target;if(e.nodeName==='IMG'&&a.dom.hasClass(e,cls))a.selection.select(e)});c.onNodeChange.add(function(a,b,n){b.setActive('morebreak',n.nodeName==='IMG'&&a.dom.hasClass(n,cls))});c.onBeforeSetContent.add(function(a,o){o.content=o.content.replace(pbRE,f)});c.onPostProcess.add(function(b,o){if(o.get)o.content=o.content.replace(/<img[^>]+>/g,function(a){if(a.indexOf('class="mceMoreBreak')!==-1)a=sep;return a})})},getInfo:function(){return{longname:'MoreBreak',author:'QFisH',authorurl:'http://QFisH.Me',infourl:'http://QFisH.Me',version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add('morebreak',tinymce.plugins.MoreBreakPlugin)})();